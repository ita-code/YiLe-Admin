import{u as B,a as F}from"./index-zMHcPrzU.js";import{r as y,z as M,b as n,d as E,G as D,c as m,s as A,C as j,k as u,_ as $,o as q,f as z,w as x,h as b,j as L,ap as V,t as I}from"./index-e7XJbop6.js";function G({el:e=window,name:a,listener:r,options:i,autoRemove:o=!0,isDebounce:h=!0,wait:d=80}){let g=()=>{};const _=y(!1);if(e){const v=y(e),S=h?B(r,d):F(r,d),w=d?S:r,f=t=>{_.value=!0,t.removeEventListener(a,w,i)},H=t=>t.addEventListener(a,w,i),N=M(v,(t,s,l)=>{t&&(!n(_)&&H(t),l(()=>{o&&f(t)}))},{immediate:!0});g=()=>{f(v.value),N()}}return{removeEvent:g}}const U={height:[Number,String],maxHeight:[Number,String],maxWidth:[Number,String],minHeight:[Number,String],minWidth:[Number,String],width:[Number,String],bench:{type:[Number,String],default:0},itemHeight:{type:[Number,String],required:!0},items:{type:Array,default:()=>[]}},p="virtual-scroll";function c(e,a="px"){if(!(e==null||e===""))return isNaN(+e)?String(e):`${Number(e)}${a}`}const J=E({name:"VirtualScroll",props:U,setup(e,{slots:a}){const r=y(null),i=D({first:0,last:0,scrollTop:0}),o=m(()=>parseInt(e.bench,10)),h=m(()=>parseInt(e.itemHeight,10)),d=m(()=>Math.max(0,i.first-n(o))),g=m(()=>Math.min((e.items||[]).length,i.last+n(o))),_=m(()=>({height:c((e.items||[]).length*n(h))})),v=m(()=>{const t={},s=c(e.height),l=c(e.minHeight),R=c(e.minWidth),T=c(e.maxHeight),W=c(e.maxWidth),C=c(e.width);return s&&(t.height=s),l&&(t.minHeight=l),R&&(t.minWidth=R),T&&(t.maxHeight=T),W&&(t.maxWidth=W),C&&(t.width=C),t});M([()=>e.itemHeight,()=>e.height],()=>{f()});function S(t){const s=n(r);if(!s)return 0;const l=parseInt(String(e.height)??0,10)||s.clientHeight;return t+Math.ceil(l/n(h))}function w(){return Math.floor(i.scrollTop/n(h))}function f(){const t=n(r);t&&(i.scrollTop=t.scrollTop,i.first=w(),i.last=S(i.first))}function H(){const{items:t=[]}=e;return t.slice(n(d),n(g)).map(N)}function N(t,s){s+=n(d);const l=c(s*n(h));return u("div",{class:`${p}__item`,style:{top:l},key:s},[a.default({item:t,index:s})])}return A(()=>{i.last=S(0),j(()=>{const t=n(r);t&&G({el:t,name:"scroll",listener:f,wait:0})})}),()=>u("div",{class:p,style:n(v),ref:r},[u("div",{class:`${p}__container`,style:n(_)},[H()])])}}),k=$(J,[["__scopeId","data-v-76462741"]]),K={class:"card content-box"},O={class:"virtual-scroll-demo-wrap"},P={class:"virtual-scroll-demo__item"},Q={class:"virtual-scroll-demo-wrap"},X={class:"virtual-scroll-demo__item"},Y=E({name:"testVirtualScroll"}),Z=E({...Y,setup(e){const a=(()=>{const r=[];for(let i=1;i<2e4;i++)r.push({title:"列表项"+i});return r})();return(r,i)=>(q(),z("div",K,[u(n(V),null,{default:x(()=>[L("基础滚动示例")]),_:1}),b("div",O,[u(k,{"item-height":41,items:n(a),height:300,width:300},{default:x(({item:o})=>[b("div",P,I(o.title),1)]),_:1},8,["items"])]),u(n(V),null,{default:x(()=>[L("即使不可见，也预先加载50条数据，防止空白")]),_:1}),b("div",Q,[u(k,{"item-height":41,items:n(a),height:300,width:300,bench:50},{default:x(({item:o})=>[b("div",X,I(o.title),1)]),_:1},8,["items"])])]))}}),nt=$(Z,[["__scopeId","data-v-0f2ece54"]]);export{nt as default};
